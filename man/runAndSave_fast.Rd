% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hvCpGDetection.R
\name{runAndSave_fast}
\alias{runAndSave_fast}
\title{Run the hvCpG algorithm and save results to file}
\usage{
runAndSave_fast(
  analysis,
  cpg_names_vec,
  resultDir,
  NCORES,
  p0,
  p1,
  overwrite = FALSE,
  batch_size = 10000,
  dataDir,
  skipsave = FALSE,
  Nds = 3,
  subsetMetadata = FALSE,
  minind = 3
)
}
\arguments{
\item{analysis}{Character string. Name of the analysis.
If it contains \code{"MariasarraysREDUCED"}, a special directory structure is expected.}

\item{cpg_names_vec}{Character vector of CpG identifiers to process.}

\item{resultDir}{Character string; output directory for result files.}

\item{NCORES}{Integer; number of CPU cores to use in parallel processing.}

\item{p0, p1}{Numeric scalars: True negative and true positive rates.}

\item{overwrite}{Logical; if \code{TRUE}, overwrite existing result file (default FALSE).}

\item{batch_size}{Integer; number of CpGs to process per batch (default 10000).}

\item{dataDir}{Character string. Path to the directory containing input data files.
Should contain \code{sample_metadata.tsv}, \code{all_medsd_lambda.tsv}, and an HDF5 matrix file.}

\item{skipsave}{Logical; if \code{TRUE}, skip saving results to disk.}

\item{Nds}{Integer; minimum number of datasets required per CpG (default 3).}

\item{subsetMetadata}{Logical or data frame. If \code{FALSE} (default), the full metadata
is used. Otherwise, a subset of the metadata can be provided to restrict
the analysis to specific samples or datasets.}

\item{minind}{Numeric scalar: Minimum number of individuals covered per dataset by CpG (default 3).}
}
\value{
Invisibly returns the result matrix (CpG x alpha).
The function also saves an \code{.RData} file to \code{resultDir} unless \code{skipsave = TRUE}.
}
\description{
Top-level driver that orchestrates hvCpG detection:
prepares data, runs the batched parallel optimisation over CpGs,
and saves the resulting alpha estimates to disk.
}
